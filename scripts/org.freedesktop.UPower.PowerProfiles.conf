<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE busconfig PUBLIC
 "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<busconfig>
  <!--
    D-Bus policy for auto-cpufreq power-profiles-daemon compatibility.

    This policy allows auto-cpufreq to provide the org.freedesktop.UPower.PowerProfiles
    interface, enabling desktop environments like GNOME and KDE to control CPU
    performance through their native power management interfaces.
  -->

  <!-- Only root can own the service (auto-cpufreq daemon runs as root) -->
  <policy user="root">
    <allow own="org.freedesktop.UPower.PowerProfiles"/>
    <allow send_destination="org.freedesktop.UPower.PowerProfiles"/>
    <allow receive_sender="org.freedesktop.UPower.PowerProfiles"/>
  </policy>

  <!-- Allow any user to interact with the service -->
  <policy context="default">
    <!-- Allow introspection -->
    <allow send_destination="org.freedesktop.UPower.PowerProfiles"
           send_interface="org.freedesktop.DBus.Introspectable"/>

    <!-- Allow reading properties -->
    <allow send_destination="org.freedesktop.UPower.PowerProfiles"
           send_interface="org.freedesktop.DBus.Properties"
           send_member="Get"/>
    <allow send_destination="org.freedesktop.UPower.PowerProfiles"
           send_interface="org.freedesktop.DBus.Properties"
           send_member="GetAll"/>

    <!-- Allow setting properties (ActiveProfile, BatteryAware) -->
    <allow send_destination="org.freedesktop.UPower.PowerProfiles"
           send_interface="org.freedesktop.DBus.Properties"
           send_member="Set"/>

    <!-- Allow calling HoldProfile and ReleaseProfile methods -->
    <allow send_destination="org.freedesktop.UPower.PowerProfiles"
           send_interface="org.freedesktop.UPower.PowerProfiles"
           send_member="HoldProfile"/>
    <allow send_destination="org.freedesktop.UPower.PowerProfiles"
           send_interface="org.freedesktop.UPower.PowerProfiles"
           send_member="ReleaseProfile"/>
    <allow send_destination="org.freedesktop.UPower.PowerProfiles"
           send_interface="org.freedesktop.UPower.PowerProfiles"
           send_member="SetActionEnabled"/>

    <!-- Allow receiving signals -->
    <allow receive_sender="org.freedesktop.UPower.PowerProfiles"/>
  </policy>
</busconfig>
